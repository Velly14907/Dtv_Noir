const DEBUG=!1;!function(){let t=[];window.addEventListener("message",(e=>{if(e.source===window&&"TK_AD_PATTERNS"===e.data?.type){const n=e.data.patterns;n&&"string"==typeof n&&(t=n.split("|").map((t=>t.trim())).filter(Boolean))}}));const e=new Set,n=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,e){return this._url="string"==typeof e?e:null,n.apply(this,arguments)};const s=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){return this.addEventListener("load",(function(){try{if(this._url&&i(this._url)){false;try{const t=JSON.parse(this.responseText);false;const e=o(t);e.length>0&&window.postMessage({type:"TKA",ads:e},"*")}catch(t){false}}}catch(t){false}})),s.apply(this,arguments)};const a=window.fetch;function i(t){return t.includes("api/recommend/item_list")||t.includes("api/preload/item_list")||t.includes("/item_list")}function o(n){if(!n)return[];const s=n?.itemList||n?.items||n?.data?.itemList||[];if(!Array.isArray(s))return[];const a=[];return s.forEach((n=>{if(!n)return;const s=function(e){for(const n of t){const t=n.includes(".")?r(e,n):e[n];if(null!=t&&!1!==t&&""!==t)return{pattern:n,value:t}}return null}(n);if(s){const t=String("object"==typeof s.value?s.value?.ad_id||n.id:s.value);if(e.has(t))return void 0;e.add(t),a.push({adId:t,adIdKey:s.pattern,rawData:n})}})),a}function r(t,e){return e.split(".").reduce(((t,e)=>t?.[e]),t)}window.fetch=async function(...t){const e=await a.apply(this,t);try{const n=t[0]?.url||t[0];if("string"==typeof n&&i(n)){false;e.clone().text().then((t=>{try{const e=o(JSON.parse(t));e.length>0&&window.postMessage({type:"TKA",ads:e},"*")}catch(t){false}})).catch((t=>{false}))}}catch(t){false}return e};let c=null;window.addEventListener("message",(t=>{t.source===window&&"TKA"===t.data?.type&&t.data?.ads?.length>0&&(c=t.data?.ads[t.data.ads.length-1]?.adId)}))}();