const DEBUG=!1;!function(){let t=[];window.addEventListener("message",(e=>{if(e.source===window&&"FB_AD_PATTERNS"===e.data?.type){const n=e.data.patterns;n&&"string"==typeof n&&(t=n.split("|").map((t=>t.trim())).filter(Boolean))}}));const e=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,n){return this._url="string"==typeof n?n:null,e.apply(this,arguments)};const n=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){return this.addEventListener("load",(function(){try{if(this._url&&this._url.includes("/api/graphql")){(this.responseText?.split("\n")||[]).forEach((e=>{try{const n=function(e){return function(e){const n=[],o=new Set;function s(r){if(Array.isArray(r))for(const t of r)s(t);else if("object"==typeof r&&null!==r){for(const s of t)if(r[s]){const t=r[s];if(t&&"boolean"!=typeof t&&("string"==typeof t||"number"==typeof t)){const s=String(t);if(!o.has(s)){o.add(s);const t=f(r);t.size>0&&n.push({postId:s,rawData:e,externalUrls:[...t]})}}}for(const t in r)s(r[t])}}return s(e),n}(e)}(JSON.parse(e));n.length>0&&window.postMessage({type:"FBA",posts:n},"*")}catch(t){false}}))}}catch(t){console.warn("XHR processing error:",t)}})),n.apply(this,arguments)};const o=/https?:\/\/[^\s<>"')\]]+/g;function s(t){try{const e=new URL(t).hostname.toLowerCase();return["l","lm"].some((t=>e===`${t}.facebook.com`))}catch{return!1}}function r(t){if(!s(t))return null;try{return new URL(t).searchParams.get("u")}catch{return null}}function c(t){try{const e=new URL(t);return e.host+e.pathname}catch{return null}}function i(t){try{const e=new URL(t).hostname.toLowerCase();if(s(t))return!0;const n=[...[".facebook.com",".fb.com",".fb.me",".fbcdn.net",".instagram.com"],...[".w3.org"]],o="."+e;return!n.some((t=>o.endsWith(t)))}catch{return!1}}function f(t,e=new Set,n=0){if(n>100)return e;if("string"==typeof t){(t.startsWith("http://")||t.startsWith("https://"))&&i(t)&&e.add(t);const n=t.match(o);if(n)for(const t of n)i(t)&&e.add(t)}else if(Array.isArray(t))for(const o of t)f(o,e,n+1);else if(t&&"object"==typeof t)for(const o in t)f(t[o],e,n+1);return e}let a={},p=[];window.addEventListener("message",(t=>{if(t.source===window&&"FBA"===t.data?.type&&t.data.posts){for(const e of t.data.posts)for(const t of e.externalUrls||[]){const n=r(t)||c(t)||t;a[n]||p.push(n),a[n]=e.postId}!function(){if(p.length<=500)return;const t=p.length-500,e=p.splice(0,t);for(const t of e)delete a[t]}()}})),document.addEventListener("click",(t=>{const e=t.target.closest("a[href]");if(!e?.href)return;const n=e.href;if(!i(n))return;const o=r(n),s=c(n);let f=o?a[o]:a[s];if(!f&&!o&&s)for(const[t,e]of Object.entries(a))if(s.includes(t)||t.includes(s)){f=e;break}if(f){const t=o||s||n;window.postMessage({type:"FB_CLICK_CONTEXT",postId:f,clickedUrl:t},"*")}else false}),!0)}();